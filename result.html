<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="robots" content="noindex">
<!-- OGP -->
<meta property="og:title" content="計算結果 - TeKeep! | あなたの交通費、最適化します">
<meta property="og:description" content="TeKeep!は、通勤・通学費を節約するための無料シミュレーター。あなたの休日設定に合わせて、最も安くなる購入プランを簡単に見つけられます。">
<meta property="og:type" content="website">
<meta property="og:url" content="https://tekeep.github.io">
<meta property="og:image" content="https://tekeep.github.io/images/logo.png">
<meta name="twitter:card" content="summary_large_image">
<title>計算結果 - TeKeep! (テイキープ)</title>
<!-- Favicon Settings -->
<link rel="icon" href="images/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="images/apple-touch-icon.png" sizes="180x180">
<link rel="icon" type="image/png" href="images/icon-192x192.png" sizes="192x192">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="css/common.css">
<link rel="stylesheet" href="css/result.css">
</head>
<body>
<div class="hamburger-menu">
  <div class="menu-btn">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav class="nav-menu">
  <ul>
    <!-- <li><a href="#" id="openContactForm" style="border-bottom: none;"><i class="fa-solid fa-fw fa-envelope"></i>お問い合わせ</a></li> -->
  </ul>
</nav>

<header style="text-align: center; margin-bottom: 30px;">
  <a href="." style="text-decoration: none; display: inline-block;">
    <img src="images/logo.png" alt="TeKeep! ロゴ" class="logo-img" style="display: block; margin: 0 auto 24px;">
  </a>
  <div style="border-top: 1px solid var(--border-color); margin-bottom: 16px;"></div>
  <h2 class="result-header" style="gap: 8px;"><i class="fa-solid fa-calculator" style="color: var(--primary-color); font-size: 24px; position: relative; top: -1px;"></i>シミュレーション結果</h2>
  <div style="border-top: 1px solid var(--border-color);"></div>
</header>

<!-- パラメータがない場合のエラー表示 -->
<div id="errorScreen" style="display: none; text-align: center; padding: 40px 20px; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
  <h2 style="font-size: 1.8rem; margin-top: 0;"><i class="fa-solid fa-circle-exclamation" style="color: var(--accent-color); margin-bottom: 12px;"></i><br>計算結果がありません</h2>
  <p style="font-size: 16px; line-height: 1.7; margin-top: 16px; color: var(--text-color);">
    表示できる計算結果がありません。<br>
    お手数ですが、トップページから再度計算を実行してください。
  </p>
    <a href="." class="button" style="margin-top: 24px; display: inline-block; min-width: 200px;">トップページに戻る</a>
</div>

<!-- お問い合わせモーダル -->
<div id="contactModal" class="modal-overlay">
  <div class="modal-content" style="height: 90%;">
    <div class="modal-header">
      <h4>お問い合わせフォーム</h4>
      <button class="modal-close-btn">&times;</button>
    </div>
    <div class="modal-body">
      <iframe id="contactIframe" src="" frameborder="0" marginheight="0" marginwidth="0">読み込んでいます…</iframe>
    </div>
  </div>
</div>

<!-- 特定商取引法に基づく表記モーダル -->
<div id="tokushohoModal" class="modal-overlay">
  <div class="modal-content" style="height: 90%; max-width: 700px;">
    <div class="modal-header">
      <h4>特定商取引法に基づく表記</h4>
      <button class="modal-close-btn">&times;</button>
    </div>
    <div class="modal-body">
      <iframe id="tokushohoIframe" src="tokushoho.html" style="width: 100%; height: 100%; border: 0;"></iframe>
    </div>
  </div>
</div>

<div id="resultScreen">
  <div class="card savings-card">
    <div class="row-head"><h4 style="display: flex; align-items: center; gap: 8px;"><i class="fa-solid fa-coins" style="color: var(--primary-color); font-size: 20px;"></i>節約額</h4></div>
    <div style="display: flex; flex-direction: column; flex-grow: 1; justify-content: center;">
      <div id="savingsLabel" class="label" style="margin-top: 4px; margin-bottom: 0;">1ヶ月定期で更新プランと比べて...</div>
      <div id="savingsAmount" class="amount">0<span>円</span></div>
      <div class="label" style="margin-top: 0; margin-bottom: auto;"><span class="emphasis">おトク</span>になります！</div>
    </div>
  </div>

  <div id="plan-promo" class="plan-promo-box">
    <!-- JSで内容を動的に設定 -->
  </div>

  <div id="purchaseListContainer" class="card">
    <div class="row-head"><h4 style="display: flex; align-items: center; gap: 8px;"><i class="fa-solid fa-list-check" style="color: var(--primary-color); font-size: 20px;"></i>最適な定期券購入プラン</h4></div>
    <ul id="purchaseList" style="margin-top: 14px;"></ul>
    <p id="calendar-link-description" style="font-size: 13px; color: #495057; margin-top: 12px; margin-bottom: 0px;; padding: 8px; background-color: #f8f9fa; border-radius: 6px; text-align: center; display: none;">
      <i class="fa-solid fa-arrow-pointer" style="margin-right: 4px;"></i>上記の日付をクリックすると、Googleカレンダーに登録できます。
    </p>
  </div>

  <div id="chartContainer" class="card">
    <div class="row-head" style="margin-top: 0;">
      <h4><i class="fa-solid fa-chart-column" style="color: var(--primary-color); font-size: 20px;"></i>コスト比較</h4>
    </div>
    <div style="height: 200px; position: relative; margin-top: 8px;">
      <canvas id="savingsChart"></canvas>
    </div>
    <div class="chart-legend" style="margin-top: 10px;">
      <strong>各プランの説明</strong>
      <ul>
        <li><strong>最適プラン:</strong> このアプリが計算した最も安くなる購入パターンです。</li>
        <li id="baselinePlanDescription"></li>
        <li id="monthlyOnFirstDescription" style="display: none;"><strong>月初1ヶ月定期:</strong> 毎月1日に1ヶ月定期を買い続けた場合のコストです。（初月が月中の場合は切符で計算）</li>
        <li><strong>すべて切符で利用:</strong> 定期を一切買わずに、出勤日をすべて切符で過ごした場合のコストです。</li>
      </ul>
    </div>
  </div>

  <!-- ▼▼▼ 広告表示エリア ▼▼▼ -->
  <div id="ad-container-result" style="background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); padding: 20px; margin-top: 24px; margin-bottom: 24px; text-align: center;">
    <!-- Amazonアソシエイト おすすめ商品ウィジェット -->
    <script type="text/javascript">
      amzn_assoc_placement = "adunit0";
      amzn_assoc_tracking_id = "tekeep-22";
      amzn_assoc_ad_mode = "search";
      amzn_assoc_ad_type = "smart";
      amzn_assoc_marketplace = "amazon";
      amzn_assoc_region = "JP";
      amzn_assoc_default_search_phrase = "節約"; // 検索キーワード
      amzn_assoc_search_bar = "false"; // 検索バー非表示
    </script>
    <script src="//z-fe.amazon-adsystem.com/widgets/onejs?MarketPlace=JP"></script>
  </div>
  <!-- ▲▲▲ 広告表示エリア ▲▲▲ -->

  <div class="card">
    <div class="row-head">
      <h4><i class="fa-solid fa-calendar-days" style="color: var(--primary-color); font-size: 20px;"></i>利用プランカレンダー</h4>
      <button id="toggleCalendarBtn" style="padding: 6px 12px; font-size: 14px; background-color: var(--light-gray); color: var(--text-color);">表示する</button>
    </div>
    <div class="accordion-content" id="calendarContainer" style="margin-top: 16px; border-top: 1px solid var(--border-color); padding-top: 16px;">
      <div id="calendarControls" style="margin-top: 12px; margin-bottom: 12px;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; margin-bottom: 8px;">
          <div>
            <label style="background: none; color: #495057; padding: 0; font-weight: 500; display: inline; margin-right: 6px;">週の始まり:</label>
            <input type="radio" name="weekStartResult" value="0" id="weekStartSun" style="width: auto; margin-right: 4px; position: relative; top: 1px;" checked><label for="weekStartSun" style="background: none; color: #495057; padding: 0; font-weight: normal; display: inline; margin-right: 6px;">日曜</label>
            <input type="radio" name="weekStartResult" value="1" id="weekStartMon" style="width: auto; margin-right: 4px; position: relative; top: 1px;"><label for="weekStartMon" style="background: none; color: #495057; padding: 0; font-weight: normal; display: inline;">月曜</label>
          </div>
          <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;">
            <button id="toggleCalendarViewBtn" style="padding: 4px 8px;">全期間表示</button>
          </div>
        </div>
        <div class="legend" style="display: flex; align-items: center; flex-wrap: wrap; gap: 10px;">
          <div style="flex-grow: 1; display: flex; align-items: center; gap: 14px; flex-wrap: wrap;">
             <div style="display: flex; align-items: center; gap: 4px;"><i class="legend-bar"></i> : 定期期間</div>
             <div style="display: flex; align-items: center; gap: 4px;"><i class="chip holiday"></i> : 休日</div>
             <div style="display: flex; align-items: center; gap: 4px; font-size: 13px;"><strong style="color: var(--accent-color); font-weight: bold;">切符</strong> : 利用日</div>
          </div>
          <div id="calendarPagingControls">
             <button id="prevMonthBtn" style="padding: 4px 8px;">＜ 前月</button>
             <button id="nextMonthBtn" style="padding: 4px 8px;">次月 ＞</button>
          </div>
        </div>
      </div>
      <div id="calendarView" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;"></div>
    </div>
  </div>
  <div id="bottomBtn">
    <button id="recalculateBtn" onclick="window.location.href='.'" style="display: block; max-width: 980px; margin: 0 auto; width: calc(100% - 30px);">再計算する</button>
  </div>
</div>

<footer style="display: none;" id="resultFooter">
  <a href="#" id="openContactFooter">お問い合わせ</a>|
  <a href="#" id="openTokushohoModal">特定商取引法に基づく表記</a>
  <div style="margin-top: 8px;">&copy; 2025 TeKeep!</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- グラフ上にデータラベルを表示するためのChart.jsプラグイン -->
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<script src="js/config.js"></script>
<script src="js/ga.js"></script>
<script src="js/result.js"></script>
</body>

</html>